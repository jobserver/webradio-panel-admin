app.controller("enquete",function(a,d,f,g,h,k,e,l){a.lista=[];a.enqueteStatus=["","Ativo","Suspenso"];a.ordenacao={campo:"data_criacao",direcao:"desc"};a.CampoBuscar=null;a.enqueteAtivo={};a.form={};a.ordernar=function(b){a.ordenacao.direcao="asc"==a.ordenacao.direcao?"desc":"asc";a.ordenacao.campo=b;a.getBusca(0,a.CampoBuscar)};a.lerEnquete=function(b){a.form=angular.copy(b);a.form.data_criacao=e("toDate")(a.form.data_criacao)};a.novaEnquete=function(){a.form={};a.form.itens=[{item:"",valor:""},
{item:"",valor:""},{item:"",valor:""},{item:"",valor:""}]};a.getBusca=function(b,c){b=void 0===b?0:b;c=void 0===c?"":c;$("#modalProcessando").modal("open");d({method:"POST",url:a.instalacao+"/admin/enquete/get/"+b,data:{filtro:c,ordenacao:a.ordenacao},headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"},timeout:3E4}).then(function(b){a.lista=b.data;$("#modalProcessando").modal("close");$("#CampoBuscar").focus()},function(a){$("#modalProcessando").modal("close");
M.toast({html:"Falha ao listar Enquetes. Verifiqe sua conex\u00e3o ou tente mais tarde.",classes:"red"})})};a.salvar=function(){$("#modalProcessando").modal("open");var b=angular.copy(a.form);b.radio_codigo=a.radioId;b.itens=angular.toJson(b.itens);d.post(a.instalacao+"/admin/enquete/salvar",b).then(function(b){$("#modalProcessando").modal("close");$("#lerEnquete").modal("close");M.toast({html:b.data.status.frase,classes:b.data.status.classe});a.getBusca()})["catch"](function(a){$("#modalProcessando").modal("close");
M.toast({html:"Erro ao salvar, tente mais tarde",classes:"red"})})["finally"](function(){$("#modalProcessando").modal("close")})};a.excluir=function(){$("#modalProcessando").modal("open");d.post(a.instalacao+"/admin/enquete/apagar",{id:a.form.id}).then(function(b){$("#modalProcessando").modal("close");$("#lerEnquete").modal("close");M.toast({html:b.data.status.frase,classes:b.data.status.classe});a.getBusca()},function(a){$("#modalProcessando").modal("close");M.toast({html:"Falha ao excluir. Verifiqe sua conex\u00e3o ou tente mais tarde.",
classes:"red"})})}});